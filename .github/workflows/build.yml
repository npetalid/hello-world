name: TestBuild

on:
  push:
    branches:
      - stable
  pull_request:
    branches:
      - stable

jobs:
  build:
    runs-on: self-hosted

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Echo build number
      run: echo ${{github.run_number}}

    - name: Run build script
      run: mvn clean install

    - name: Set Version
      run: echo "VERSION=1.0.${{ github.run_number }}" >> $GITHUB_ENV

    - name: Tag and Push
      run: |
        git config user.email "nikos@petalidis.gr"
        git config user.name "Nikos Petalidis"
        git tag $VERSION
        git push origin $VERSION
